max_step = 100

# geometry parameters - coarse domain
geometry.prob_lo = 0.0 0.0 0.0
geometry.prob_hi = 60.0 40.0 30.0
geometry.is_periodic = 0 0 0

# timestepping - coarse grid for thick cracks
amr.n_cell  = 60 40 30
amr.max_level = 0
amr.max_grid_size = 64
amr.blocking_factor_x = 2
amr.blocking_factor_y = 2
amr.blocking_factor_z = 2
amr.plot_int = 10
amr.chk_int = 1000
amr.file_name_digits = 5

lbm.bc_lo = 2 5 5
lbm.bc_hi = 5 5 5
lbm.dx_outer = 1.0
lbm.dt_outer = 1.0

#nu = u D / Re
#nu = M a D / Re
#nu = M sqrt(gamma R T) D / Re
#nu = 0.1 sqrt(1.4 1 0.03333) 30 / 100 

lbm.nu = 0.00648
lbm.alpha = 0.00648
lbm.initial_temperature = 0.03333
lbm.adiabatic_exponent = 1.4
lbm.save_streaming = 0
# lbm.compute_forces = 1

lbm.body_is_isothermal = 1
lbm.body_temperature = 0.060

lbm.velocity_bc_type = "parabolic"
velocity_bc_parabolic.Mach_ref = 0.01
velocity_bc_parabolic.normal_dir = 1
velocity_bc_parabolic.tangential_dir = 0
velocity_bc_parabolic.initial_density = 1.0
velocity_bc_parabolic.initial_temperature = 0.03333
velocity_bc_parabolic.adiabatic_exponent = 1.4

lbm.ic_type = "constant"
ic_constant.mach_components = 0.0 0.0 0.0
ic_constant.density = 1.0
ic_constant.initial_temperature = 0.03333
ic_constant.adiabatic_exponent = 1.4

# eb2.geom_type = "cylinder"
# eb2.cylinder_radius = 15.0
# eb2.cylinder_center = 60.0 60.0 0.0
# eb2.cylinder_has_fluid_inside = 0
# eb2.cylinder_height = 1000.0
# eb2.cylinder_direction = 2

# eb2.geom_type = "plane"
# eb2.plane_point = 0 1 0
# eb2.plane_normal = 0.0 -1.0 0

# Best quality STL - refined volume downsampled with preserved connectivity
eb2.geom_type = "stl"
eb2.stl_file = "/Users/nsawant/apps/nileshsawant/marblesThermal/Tests/test_files/isothermal_cracks/microstructure_nX60_nY40_nZ30_combined.stl"
eb2.stl_scale = 1.0
eb2.stl_reverse_normal = 0
eb2.cover_multiple_cuts = 1

# Small cell handling for complex geometry
eb2.small_volfrac = 1e-6

amrex.fpe_trap_invalid = 1
amrex.fpe_trap_zero = 1
amrex.fpe_trap_overflow = 1
amrex.the_arena_is_managed = 0
amrex.abort_on_out_of_gpu_memory = 1